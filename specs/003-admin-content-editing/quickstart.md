# Quickstart: 後台輕鬆修改網站內容

本文件供開發與驗收時快速對齊環境與情境。

---

## 前置條件

- Node 18+
- 專案依賴已安裝：`npm install`
- Supabase 專案已設定，且 `.env.local` 含 `NEXT_PUBLIC_SUPABASE_URL`、`NEXT_PUBLIC_SUPABASE_ANON_KEY`
- 至少一筆 `profiles` 的 `is_admin = true`（對應登入用帳號）

---

## 啟動與進入後台

1. 開發伺服器：`npm run dev`
2. 以具 `is_admin` 的帳號登入（依專案現有登入流程）。
3. 進入後台：導覽至 `/admin/dashboard`（或專案實際後台首頁路徑）。

---

## 驗收情境對齊（spec 摘要）

- **快速找到內容**：從後台首頁／導覽在 2 分鐘內進入「編輯某一集」或「審核某則留言」，並完成一筆修改。
- **編輯有回饋**：編輯單集（如標題或 AI 大綱）→ 儲存 → 1 分鐘內確認成功訊息，並在前台看到更新。
- **未儲存提示**：編輯頁改動後未儲存就離開（導覽或關閉分頁）→ 出現「有未儲存的變更，確定要離開嗎？」一類提示，可取消離開。
- **衝突提示**：當該筆在編輯期間被 n8n 或他人更新（updated_at 較新）→ 儲存前或儲存時提示「有更新版本」，可選擇重新載入、覆蓋或放棄。
- **留言審核**：留言管理頁依狀態（待審／已通過／隱藏／垃圾）篩選，對單筆執行通過／隱藏／標記垃圾；列表更新。
- **上架狀態**：單集（或節目）列表顯示每筆上架狀態，一鍵切換上架／下架；前台重新整理後反映。
- **分頁**：單集、留言、聯盟內容列表每頁約 20 筆，有上一頁／下一頁或頁碼可切換。

### FR-007 前台可見性驗證

前台首頁（最新百科收錄）、節目頁、單集詳情皆依 `is_published` 篩選；僅 `is_published = true` 的單集會出現在列表與詳情頁。後台在單集列表將一筆改為「上架」或「下架」後，重新整理前台對應頁面即可確認：上架後會出現、下架後會消失。

---

## 與 n8n 並行時

- 資料主要由 n8n 上傳至 Supabase；後台用於快速小修。
- 若同一筆在站長編輯時被 n8n 更新，實作須依 `updated_at` 偵測並提示（見 [research.md](../research.md) 與 [contracts/README.md](./contracts/README.md)）。

---

## 相關文件

- [spec.md](../spec.md)：完整規格與驗收情境  
- [plan.md](../plan.md)：技術脈絡與結構  
- [research.md](../research.md)：技術決策（未儲存提示、衝突、分頁、登入）  
- [data-model.md](../data-model.md)：相關實體與欄位  
- [contracts/README.md](./contracts/README.md)：列表分頁與衝突偵測之 API 契約
