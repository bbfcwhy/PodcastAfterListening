# Feature Specification: 後台輕鬆修改網站內容

**Feature Branch**: `003-admin-content-editing`  
**Created**: 2026-01-29  
**Status**: Draft  
**Input**: User description: "我希望有一個後台，可以讓我很輕鬆的去修改這個網站的內容"

## Clarifications

### Session 2026-01-29

- Q: 站長在編輯頁有未儲存變更就離開時，要不要實作「離開前提示未儲存」？ → A: 要提示（若有未儲存變更則顯示確認，不強制阻擋離開但可讓使用者取消離開）
- Q: 站長在編輯時同一筆內容被 n8n 或外部流程更新，衝突時要「最後寫入勝出」還是「提示有更新版本」？ → A: 提示有更新版本（偵測到遠端有更新時提示站長，可選擇重新載入、覆蓋或放棄）
- Q: 單集／節目／留言列表是否需要分頁或上限？ → A: 分頁（列表採分頁，如每頁 20 筆，載入與導覽穩定）
- Q: 第一版是否實作預覽或草稿？ → A: 兩者都暫不實作；網站資料以 n8n 上傳 Supabase 為主，後台僅供發現小問題時快速修改，預覽與草稿非必須。

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 快速找到要改的內容 (Priority: P1)

站長登入後台後，能透過清楚的導覽與搜尋，快速找到要修改的節目、單集、留言或聯盟內容，不需要來回點選多層選單或記憶網址。

**Why this priority**: 若找不到要改的項目，後台再強也無用；減少「找內容」的時間是輕鬆修改的前提。

**Independent Test**: 以站長身份登入後台，在兩分鐘內從首頁導覽至「編輯某一集節目」或「審核某則留言」的頁面，並完成一筆修改。

**Acceptance Scenarios**:

1. **Given** 站長已登入後台, **When** 進入後台首頁或導覽列, **Then** 能一眼辨識節目／單集／留言／聯盟等內容入口，且命名與實際內容一致
2. **Given** 站長在單集列表, **When** 使用搜尋或篩選（依標題、上架狀態等）, **Then** 能縮小範圍並找到目標項目
3. **Given** 站長在任一列表頁, **When** 點擊「編輯」或等同操作, **Then** 進入該筆內容的編輯介面，且無需多餘步驟

---

### User Story 2 - 編輯過程簡單、有回饋 (Priority: P1)

站長在編輯節目、單集或聯盟內容時，表單欄位清楚標示、必填與選填分明，儲存後能立即得到成功或失敗的明確回饋；若驗證失敗，能知道是哪一欄有問題並易於修正。

**Why this priority**: 表單難填或儲存無回饋會讓「修改」變成負擔，直接影響站長是否願意經常更新內容。

**Independent Test**: 在後台編輯一筆單集（例如修改標題或 AI 大綱），提交後在一分鐘內確認儲存結果，並在前台看到更新內容。

**Acceptance Scenarios**:

1. **Given** 站長在編輯表單頁, **When** 檢視表單, **Then** 必填欄位有標示，選填欄位可辨識，長文欄位（如大綱、心得）有足夠輸入空間
2. **Given** 站長已修改欄位並點擊儲存, **When** 儲存成功, **Then** 顯示明確的成功訊息，並可選擇返回列表或繼續編輯
3. **Given** 站長送出表單但必填欄位未填或格式錯誤, **When** 驗證失敗, **Then** 顯示具體錯誤說明（例如「標題不可為空」），並將焦點或標示指向問題欄位
4. **Given** 站長在編輯頁面, **When** 意外關閉分頁或離開前未儲存, **Then** 若有未儲存變更，系統須提示使用者（如「有未儲存的變更，確定要離開嗎？」），不強制阻擋離開但可讓使用者選擇取消離開

---

### User Story 3 - 留言審核與內容狀態一目了然 (Priority: P2)

站長在後台管理留言時，能依狀態（待審、已通過、隱藏、垃圾）篩選與操作，且單集列表能清楚看到「已上架／未上架」等狀態，必要時能快速切換上架狀態。

**Why this priority**: 內容狀態與審核是日常維護的一部分，若混在一起或難以篩選，會增加站長負擔。

**Independent Test**: 在後台篩選「待審留言」，對一則留言執行通過或隱藏，並確認列表更新；另在單集列表將一筆改為上架或下架，並在前台確認顯示與否。

**Acceptance Scenarios**:

1. **Given** 站長在留言管理頁, **When** 選擇篩選條件（如「待審」）, **Then** 僅顯示符合條件的留言，且可對單筆執行通過、隱藏或標記垃圾
2. **Given** 站長在單集列表, **When** 檢視列表, **Then** 每筆顯示上架狀態（如已上架／未上架），且能透過單一操作（如按鈕或開關）切換狀態
3. **Given** 站長變更某筆內容的上架狀態, **When** 儲存, **Then** 前台在合理時間內（如重新整理後）反映該變更

---

### User Story 4 - 可選：修改前預覽或草稿 (Priority: P3)

站長在編輯單集或節目時，可選擇在儲存前預覽前台顯示效果，或將修改存為草稿而不立即影響前台。**第一版不實作**：網站資料以 n8n 上傳 Supabase 為主，後台僅供快速小修，預覽與草稿非本版範圍；若未來有需求可另案加入。

**Why this priority**: 能降低改錯的風險並提升信心，但非最小可行後台的必備項。

**Independent Test**: 若有預覽功能，在編輯頁點擊「預覽」後，能在新分頁或區塊看到與前台一致的顯示；若有草稿，儲存草稿後前台仍顯示原內容，直到站長選擇「發布」。

**Acceptance Scenarios**:

1. **Given** 站長在編輯單集或節目頁且已修改內容, **When** 點擊「預覽」, **Then** 以當前輸入內容顯示與前台相同版型的預覽（可為新分頁或模態）
2. **Given** 系統支援草稿, **When** 站長儲存為草稿, **Then** 變更不立即顯示於前台，且站長之後可從同一編輯頁「發布」使前台更新

---

### Edge Cases

- 站長在編輯時，同一筆內容被 n8n 或外部流程更新（例如 AI 重新上傳）：系統須避免靜默覆蓋；偵測到遠端有更新時須提示站長（如「此筆內容已有更新版本」），並提供選項讓站長選擇重新載入、覆蓋或放棄儲存。
- 必填欄位依賴外部資料（例如單集所屬節目）：若節目被刪除，編輯介面應顯示明確狀態（如「所屬節目已刪除」）並引導站長選擇其他節目或處理方式。
- 長文欄位（大綱、心得）內容過大：系統應能儲存並顯示，或明確限制長度並在表單上標示，避免儲存時才失敗。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統 MUST 提供後台統一入口（如儀表板或導覽列），讓站長能直接進入節目、單集、留言、聯盟內容等管理頁面，無需記憶多個網址。
- **FR-002**: 系統 MUST 在單集列表提供搜尋或篩選（至少依標題、上架狀態），使站長能快速定位要編輯的項目。
- **FR-003**: 系統 MUST 在站長儲存編輯後給予明確成功或失敗回饋；失敗時 MUST 指出問題欄位或原因，以便修正。
- **FR-004**: 系統 MUST 在編輯表單上區分必填與選填欄位，且必填欄位在送出時驗證，未通過時阻止儲存並顯示錯誤訊息。
- **FR-005**: 系統 MUST 在留言管理頁提供依狀態（如待審、已通過、隱藏、垃圾）篩選與單筆審核操作（通過、隱藏、標記垃圾）。
- **FR-006**: 系統 MUST 在單集列表顯示上架狀態，並提供站長一鍵（或最少步驟）切換上架／下架。
- **FR-007**: 系統 MUST 確保站長在後台所為「已上架」的內容，在訪客端可見；「未上架」或下架內容不在前台公開顯示。
- **FR-008**: 系統 MAY 提供「預覽」或「草稿」功能，使站長在正式更新前台前可預覽或暫存變更；若提供，預覽內容須與前台版型一致，草稿不得直接顯示於前台。**第一版不實作**。
- **FR-009**: 系統 MUST 在站長於編輯頁有未儲存變更而欲離開（導覽、關閉分頁等）時，提示確認（如「有未儲存的變更，確定要離開嗎？」）；不強制阻擋離開，但須讓使用者可選擇取消離開。
- **FR-010**: 當站長正在編輯的內容已被 n8n 或外部流程更新（例如依 `updated_at` 或版本號偵測）時，系統 MUST 提示站長有更新版本，並提供選項（如重新載入、覆蓋、放棄儲存）；不得靜默覆蓋站長未儲存的變更。
- **FR-011**: 系統 MUST 在單集、留言、聯盟內容等後台列表提供分頁（如每頁 20 筆），以穩定載入與導覽；須提供分頁控制（如上一頁／下一頁或頁碼）讓站長可切換頁面。

### Key Entities

- **站長**：具後台存取權之單一角色，可編輯節目、單集、留言、聯盟內容及上架狀態。
- **可編輯內容**：節目（節目系列）、單集（含 AI 大綱、心得、業配等）、留言（審核狀態）、聯盟行銷內容；狀態包含是否上架、留言是否通過等。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 站長從登入後台到完成「找到並編輯一筆單集並儲存」可在 3 分鐘內完成（在熟悉流程的前提下）。
- **SC-002**: 站長儲存編輯後，能在 5 秒內看到成功或失敗的明確訊息；若失敗，能從訊息或介面得知至少一項需修正的欄位或原因。
- **SC-003**: 站長在留言管理頁透過篩選與操作，能在 2 分鐘內完成對 10 則以內待審留言的審核（通過或隱藏）。
- **SC-004**: 站長在單集列表能辨識每筆的上架狀態，且能在一次操作內切換上架／下架，並在重新整理前台後確認結果符合預期。
- **SC-005**: 至少 80% 的後台常用操作（進入列表、搜尋、編輯、儲存、審核留言、切換上架）可在不超過 3 次點擊內完成（從後台首頁或固定導覽起算）。

## Assumptions

- 後台使用者仍為單一站長，不涉及多角色權限或審核流程分工。
- 「網站內容」指現有產品範圍內的節目、單集、留言、聯盟內容及其上架狀態，不包含任意自訂頁面或全站靜態文案的 CMS（若未來需要可另案規劃）。
- 現有後台已有節目／單集／留言／聯盟等 CRUD 與審核能力，本規格著重於「讓既有操作更輕鬆」，而非從零建置所有管理功能。
- 網站內容主要來自 n8n 上傳至 Supabase；後台介面供站長在發現小問題時快速修改，非主要內容產製入口。第一版不實作預覽與草稿，若未來有需求可另案加入。
