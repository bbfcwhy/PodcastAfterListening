# 功能規格：後台節目管理增強 (Admin Show Management Enhancements)

## 1. 概述 (Overview)

本功能旨在優化後台節目管理介面，提升管理員操作效率。主要新增篩選、排序、分頁以及手動拖曳排序功能。

## 2. 使用者故事 (User Stories)

-   **作為管理員**，我希望能夠**篩選**節目列表，以便快速找到特定類型的節目（例如：已發布/草稿）。
-   **作為管理員**，我希望能夠**排序**節目列表（例如：按名稱、建立時間），以便更有序地檢視資料。
-   **作為管理員**，我希望節目列表具有**分頁**功能，避免單頁載入過多資料，並能設定每頁顯示數量。
-   **作為管理員**，我希望能夠**手動拖曳**調整節目的顯示順序，以控制前台的推薦順序。

## 3. 功能需求 (Functional Requirements)

### 3.1 篩選與排序 (Filter & Sort)
-   **篩選條件**：
    -   關鍵字搜尋（名稱、描述）。
    -   Categories (雖然目前資料庫結構可能未正規化，但在前台有顯示 tag，後台應可篩選)。
    -   *註：若無明確狀態欄位 (e.g. is_published)，則暫不實作狀態篩選，或依現有欄位調整。*
-   **排序欄位**：
    -   名稱 (A-Z, Z-A)
    -   更新時間 (最新/最舊)
    -   建立時間 (最新/最舊)
    -   **自訂排序 (Custom Order)**：預設排序方式 (依照 `position` 欄位)，支援拖曳。

### 3.2 分頁控制 (Pagination)
-   每頁顯示筆數選擇：10, 20, 50, 100。
-   分頁導航：上一頁、下一頁、頁碼跳轉。
-   顯示總筆數與當前範圍 (e.g. "Showing 1-10 of 50")。

### 3.3 手動拖曳排序 (Drag-and-Drop Sorting)
-   **影響範圍**：此排序**直接影響前台側邊欄 (Sidebar) 的節目列表順序**。
-   在列表模式下，預設啟用「手動排序」模式（即依照 `position` 排序）。
-   **分頁互動**：
    -   支援在當前分頁內拖曳調整順序。
    -   若需跨頁調整（例如將第 1 頁的節目移至第 3 頁），使用者需將「每頁顯示筆數」切換為「顯示全部 (Show All)」或足夠大的數值。
-   拖曳完成後，自動更新 `shows` 表格的 `position` 欄位。
-   **注意**：當啟用篩選或非「自訂排序」時，禁用拖曳排序功能。

## 4. 資料庫變更 (Database Changes)

-   **Table**: `shows`
    -   新增 `position` (Integer)：用於儲存手動排序的順序。
    -   Migration: `ALTER TABLE shows ADD COLUMN position INTEGER DEFAULT 0;`
    -   Migration: 初始化現有資料的 `position` (例如依照 `created_at` 給予初始值)。

## 5. 介面設計 (UI Design)

-   **Toolbar**: 位於列表上方
    -   左側：搜尋框、篩選下拉選單。
    -   右側：排序下拉選單、每頁筆數選擇。
-   **Show List**:
    -   新增 "Sort Order" 欄位（可隱藏，僅在拖曳模式顯示）。
    -   Drag Handle icon (::) 於每列最前方。
-   **Pagination**: 位於列表下方。

## 6. 驗收標準 (Acceptance Criteria)

1.  管理員可透過關鍵字搜尋節目。
2.  管理員可切換每頁顯示數量，並正確分頁。
3.  管理員可依名稱或時間排序列表。
4.  在預設排序模式下，管理員可拖曳調整節目順序，並於重整後維持該順序。
5.  在非預設排序或篩選狀態下，拖曳功能應被鎖定或提示不可用。
