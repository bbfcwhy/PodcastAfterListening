# 測試報告分析指南

## 查看測試報告

### 方法 1：使用 Playwright 命令（推薦）

```bash
npx playwright show-report
```

這會自動打開瀏覽器顯示最新的測試報告，包含：
- 測試通過/失敗統計
- 每個測試的詳細結果
- 截圖和錯誤訊息
- 執行時間

### 方法 2：直接打開 HTML 報告

```bash
open playwright-report/index.html
# 或
xdg-open playwright-report/index.html  # Linux
```

## 報告內容說明

### 測試摘要

報告會顯示：
- **總測試數**：所有測試案例的總數
- **通過**：成功通過的測試數量
- **失敗**：失敗的測試數量
- **跳過**：被跳過的測試數量（使用 `test.skip()`）

### 測試詳細資訊

每個測試會顯示：
- **測試名稱**：測試的描述
- **執行時間**：測試執行的時間
- **狀態**：通過、失敗或跳過
- **截圖**：失敗時的截圖（如果有）
- **錯誤訊息**：失敗的原因
- **Trace**：詳細的執行追蹤（如果啟用）

## 常見問題分析

### 問題 1：所有測試都失敗

**可能原因**：
1. 開發伺服器未啟動
2. 環境變數未設定
3. 資料庫連線失敗
4. 頁面元素選擇器不正確

**解決方案**：
1. 確認開發伺服器正在運行
2. 檢查 `.env.local` 是否正確設定
3. 檢查 Supabase 連線
4. 使用 `page.pause()` 暫停測試檢查頁面

### 問題 2：部分測試失敗

**可能原因**：
1. 測試資料不存在
2. 頁面結構改變
3. 選擇器不正確
4. 時序問題（元素尚未載入）

**解決方案**：
1. 檢查測試資料是否存在
2. 更新選擇器以匹配實際頁面
3. 添加等待邏輯（`page.waitForSelector()`）
4. 使用 `test.setTimeout()` 增加超時時間

### 問題 3：測試不穩定（有時通過有時失敗）

**可能原因**：
1. 競態條件
2. 網路延遲
3. 資料庫查詢時間不穩定

**解決方案**：
1. 添加適當的等待邏輯
2. 使用 `page.waitForLoadState()`
3. 增加重試次數

## 測試報告最佳實踐

### 1. 定期檢查報告

每次執行測試後，檢查報告以：
- 確認所有測試通過
- 發現潛在問題
- 追蹤測試覆蓋率

### 2. 分析失敗原因

對於失敗的測試：
1. 查看錯誤訊息
2. 檢查截圖（如果有）
3. 查看 Trace（如果啟用）
4. 重現問題

### 3. 持續改進

根據測試結果：
- 修復失敗的測試
- 改進測試穩定性
- 添加更多測試案例
- 優化測試執行時間

## 相關資源

- [Playwright 測試報告文檔](https://playwright.dev/docs/test-reporters)
- [測試指南](./TESTING_GUIDE.md)
- [測試狀態](./TEST_STATUS.md)
